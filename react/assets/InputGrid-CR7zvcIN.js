import{r as e,a as qe,B as ae,c as le,u as A,f as ke,o as U,m as xe,F as Pe,e as ve,K as We,n as Be,y as He,E as je,z as Ke,b as Y}from"./index-BdnqXF1d.js";import{L as Re}from"./Label-B85wVLYy.js";import{I as Fe}from"./Input-BCd8ji8s.js";import{T as Ge}from"./Textarea-BA708rir.js";import{I as Le}from"./Icon-D2HgW1iQ.js";import{I as ce}from"./InputWithDecorations-BI9Y0tL-.js";import{M as Ue}from"./MenuExtraContent-DCcEYtvO.js";import{a as Ye,I as fe,b as Je,A as Qe,S as ne}from"./Select-DRJhdWjV.js";import{T as Xe}from"./Text-SttThymx.js";import{S as Ze}from"./SvgCaretDownSmall-OMJSkiqd.js";import{u as _e}from"./useContainerWidth-C5e-Mi9Q.js";import{L as et}from"./List-OxnXPwN9.js";import{u as tt}from"./useVirtualScroll-BCb3EmDA.js";import{L as re}from"./ListItem-CsVISolY.js";import{S as rt}from"./SvgCheckmark-4v7ocBiS.js";const me=e.forwardRef((a,o)=>{let{children:f,startIcon:i,status:r,className:s,iconProps:l,contentProps:u,...t}=a,m=i??(r&&qe[r]()),x=i!==null&&!!m;return e.createElement(ae,{className:le("iui-status-message",s),"data-iui-status":r,ref:o,...t},x?e.createElement(Le,{"aria-hidden":!0,...l},m):null,e.createElement(ae,u,f))}),at=e.forwardRef((a,o)=>{let{label:f,disabled:i,required:r,status:s,message:l,icon:u,isLabelInline:t,children:m,className:x,style:R,statusMessage:b,inputId:y,labelId:E,...c}=a;return e.createElement(ae,{className:le("iui-input-grid",x),"data-iui-status":s,"data-iui-label-placement":t?"inline":void 0,style:R,ref:o,...c},f&&e.createElement(Re,{as:y&&a.as!=="label"?"label":"div",required:r,disabled:i,htmlFor:y,id:E},f),m,b||l&&e.createElement(me,{startIcon:u,status:s},l))}),pe=e.createContext(void 0),J=e.createContext(void 0),nt=e.forwardRef((a,o)=>{let{className:f,children:i,disabled:r,isOpen:s,...l}=a;return e.createElement(Le,{as:"span",ref:o,className:le("iui-end-icon",{"iui-disabled":r,"iui-open":s},f),...l},i??e.createElement(Ze,{"aria-hidden":!0}))}),lt=e.forwardRef((a,o)=>{let{selectedItems:f=[],...i}=a;return e.createElement(Ye,{ref:o,tags:f,...i})}),it=e.forwardRef((a,o)=>{let{selectTags:f,size:i,style:r,...s}=a,{isOpen:l,id:u,focusedIndex:t,setFocusedIndex:m,enableVirtualization:x,multiple:R,onClickHandler:b,popover:y,show:E,hide:c}=A(J),{inputRef:ie,menuRef:w,optionsExtraInfo:C}=A(pe),be=ke(ie,y.refs.setReference,o),k=U(t??-1),Ie=V=>{var d,h;return((h=(d=w.current)==null?void 0:d.querySelector(`[data-iui-index="${V}"]`))==null?void 0:h.id)??""},Q=e.useCallback(V=>{var h,Z,z,_,$,L,P,W,T,N;let d=Object.keys(C).length??0;if(!V.altKey)switch(V.key){case"ArrowDown":{if(V.preventDefault(),!l)return E();if(d===0)return;if(k.current===-1){let S=(h=w.current)==null?void 0:h.querySelector("[data-iui-index]");return m(Number((S==null?void 0:S.getAttribute("data-iui-index"))??0))}if(x&&!((z=(Z=w.current)==null?void 0:Z.querySelector(`[data-iui-index="${k.current}"]`))!=null&&z.nextElementSibling))return;let M=k.current;do{let S=(_=w.current)==null?void 0:_.querySelector(`[data-iui-index="${M}"]`),v=(S==null?void 0:S.nextElementSibling)??(($=w.current)==null?void 0:$.querySelector("[data-iui-index]"));if(M=Number(v==null?void 0:v.getAttribute("data-iui-index")),v)return m(M)}while(M!==k.current);break}case"ArrowUp":{if(V.preventDefault(),!l)return E();if(d===0||x&&!((P=(L=w.current)==null?void 0:L.querySelector(`[data-iui-index="${k.current}"]`))!=null&&P.previousElementSibling))return;if(k.current===-1)return m(((W=Object.values(C))==null?void 0:W[d-1].__originalIndex)??-1);let M=k.current;do{let S=(T=w.current)==null?void 0:T.querySelector(`[data-iui-index="${M}"]`),v=(S==null?void 0:S.previousElementSibling)??((N=w.current)==null?void 0:N.querySelector("[data-iui-index]:last-of-type"));if(M=Number(v==null?void 0:v.getAttribute("data-iui-index")),v)return m(M)}while(M!==k.current);break}case"Enter":V.preventDefault(),l?k.current>-1&&(b==null||b(k.current)):E();break;case"Escape":V.preventDefault(),c();break;case"Tab":c();break}},[m,x,k,l,w,b,C,E,c]),X=e.useRef(!1),F=e.useCallback(()=>{X.current=l},[l]),O=e.useCallback(()=>{X.current?c():E(),X.current=!1},[c,E]),[j,q]=_e();return e.createElement(e.Fragment,null,e.createElement(Fe,{ref:be,"aria-expanded":l,"aria-activedescendant":l&&t!=null&&t>-1?Ie(t):void 0,role:"combobox","aria-controls":l?`${u}-list`:void 0,"aria-autocomplete":"list",spellCheck:!1,autoCapitalize:"none",autoCorrect:"off",style:{...R&&{paddingInlineStart:q+18},...r},size:i,...y.getReferenceProps({...s,onPointerDown:xe(a.onPointerDown,F),onClick:xe(a.onClick,O),onKeyDown:xe(a.onKeyDown,Q)})}),R&&f?e.createElement(lt,{ref:j,selectedItems:f}):null)}),st=e.forwardRef((a,o)=>{let{className:f,status:i,message:r,children:s,...l}=a,{id:u}=A(J);return e.createElement(at,{className:f,status:i,statusMessage:typeof r=="string"?e.createElement(me,{status:i},r):e.isValidElement(r)&&e.cloneElement(r,{status:i}),ref:o,...l,id:u},e.createElement(fe,null,s))});let ot=a=>{let{children:o,...f}=a,{filteredOptions:i,getMenuItem:r,focusedIndex:s}=A(J),{menuRef:l}=A(pe),u=e.useMemo(()=>{let b=0;for(let y=0;y<Math.min(5,i.length);y++)i[y].sublabel&&b++;return b>=Math.min(3,i.length)},[i]),t=e.useMemo(()=>{var y;let b=(y=l.current)==null?void 0:y.querySelector(`[data-iui-index="${s}"]`);return b?Number(b.getAttribute("data-iui-filtered-index")??s):s},[s,l]),{virtualizer:m,css:x}=tt({count:i.length||1,getScrollElement:()=>l.current,estimateSize:()=>u?48:36,gap:-1});ve(()=>{m.scrollToIndex(t)},[m,t]);let R=e.useCallback(b=>{let y=i.length>0?r(i[b.index],b.index):o;return e.cloneElement(y,{key:b.key,ref:m.measureElement,"data-iui-virtualizer":"item",style:{width:"100%",transform:`translateY(${b.start}px)`}})},[i,r,o,m.measureElement]);return e.createElement("div",{style:{display:"contents"}},e.createElement(We,{css:x},e.createElement(ae,{as:"div","data-iui-virtualizer":"root",...f,style:{minBlockSize:m.getTotalSize(),...a.style}},e.createElement("slot",null))),e.createElement(e.Fragment,null,m.getVirtualItems().map(b=>R(b))))};const ut=e.forwardRef((a,o)=>{let{className:f,children:i,style:r,portal:s=!0,...l}=a,{id:u,enableVirtualization:t,popover:m}=A(J),{menuRef:x}=A(pe),R=ke(m.refs.setFloating,o,x);return m.open&&e.createElement(Pe,{portal:s},e.createElement(et,{as:"div",className:le("iui-menu",f),id:`${u}-list`,role:"listbox",ref:R,...m.getFloatingProps({style:t?{maxInlineSize:0,...r}:r,...l})},t?e.createElement(ot,null,i):i))}),dt=e.memo(e.forwardRef((a,o)=>{let{children:f,isSelected:i,disabled:r,value:s,onClick:l,sublabel:u,size:t=u?"large":"default",startIcon:m,endIcon:x,role:R="option",index:b,...y}=a,{focusedIndex:E,enableVirtualization:c}=A(J),w=ke(o,C=>{!c&&E===b&&(C==null||C.scrollIntoView({block:"nearest"}))});return e.createElement(re,{as:"div",actionable:!0,size:t,active:i,disabled:r,focused:E===b,ref:w,onClick:()=>l==null?void 0:l(),role:R,tabIndex:R==="presentation"?void 0:-1,"aria-selected":i,"aria-disabled":r,"data-iui-index":b,...y},m&&e.createElement(re.Icon,{as:"span","aria-hidden":!0},m),e.createElement(re.Content,null,f,u&&e.createElement(re.Description,null,u)),x||i&&e.createElement(re.Icon,{as:"span","aria-hidden":!0},x??e.createElement(rt,null)))}));let D=(a,o)=>o&&(Array.isArray(a)||a==null),ct=(a,o)=>!o,Se=(a,o)=>a.id??`${o}-option-${a.label.replace(/\s/g,"-")}`;const we=e.forwardRef((a,o)=>{var Ve;let f=Be(),i=e.useCallback((n,p)=>n.filter(I=>I.label.toLowerCase().includes(p.toLowerCase())),[]),{options:r,value:s,onChange:l,filterFunction:u=i,inputProps:t,endIconProps:m,dropdownMenuProps:{middleware:x,...R}={},emptyStateMessage:b="No options found",itemRenderer:y,enableVirtualization:E=!1,multiple:c=!1,onShow:ie,onHide:w,id:C=t!=null&&t.id?`iui-${t.id}-cb`:f,defaultValue:be,clearFilterOnOptionToggle:k=!0,...Ie}=a,Q=e.useRef(null),X=e.useRef(null),F=U(l),O=U(r),j=U(u),q=e.useMemo(()=>{let n={};return r.forEach((p,I)=>{n[Se(p,C)]={__originalIndex:I}}),n},[C,r]),V=e.useCallback(n=>{if(n!==void 0){if(!D(n,c))return r.findIndex(p=>p.value===n);{let p=[];return n==null||n.forEach(I=>{let g=r.findIndex(B=>B.value===I);g>-1&&p.push(g)}),p}}},[c,r]),[d,h]=He(V(be)??(c?[]:-1),V(s)),Z=e.useRef(s);ve(()=>{s!==Z.current&&(Z.current=s,s===void 0&&(D(d,c)?h([]):h(-1)))},[c,d,h,s]);let[z,_]=e.useState(!1),[$,L]=e.useState(-1),P=U(ie),W=U(w),T=e.useCallback(()=>{var n;_(!0),(n=P.current)==null||n.call(P)},[P]),N=e.useCallback(()=>{var n;_(!1),(n=W.current)==null||n.call(W)},[W]);ve(()=>{var n,p;z?((n=Q.current)==null||n.focus(),D(d,c)||L(d??-1)):(L(-1),D(d,c)?v(""):v(d>=0?((p=O.current[d])==null?void 0:p.label)??"":""),ge(!1))},[z,c,O,d]);let M=e.useRef(r);e.useEffect(()=>{r!==M.current&&(M.current=r,n());function n(){var p;D(d,c)?L(-1):L(d),!D(d,c)&&!z&&v(d>=0?(p=r[d])==null?void 0:p.label:"")}},[r,z,c,d]);let[S,v]=e.useState(((Ve=t==null?void 0:t.value)==null?void 0:Ve.toString())??""),[he,ge]=e.useState(!1),se=e.useMemo(()=>{var n;return he?(n=j.current)==null?void 0:n.call(j,r,S):r},[j,S,r,he]),[Ne,De]=e.useState(""),Te=e.useCallback(n=>{var I;let{value:p}=n.currentTarget;v(p),T(),ge(!0),$!=-1&&L(-1),(I=t==null?void 0:t.onChange)==null||I.call(t,n)},[$,t,T]),ee=e.useCallback(n=>D(d,c)?d.includes(n):d===n,[c,d]),Me=e.useCallback((n,p)=>{if(D(d,c))return p==="added"?[...d,n]:d==null?void 0:d.filter(I=>I!==n)},[d,c]),ye=e.useCallback((n,p,I)=>{var g,B,G,H;ct(F.current,c)?(B=F.current)==null||B.call(F,(g=O.current[n])==null?void 0:g.value):p&&I&&((H=F.current)==null||H.call(F,I==null?void 0:I.map(Ce=>{var oe;return(oe=O.current[Ce])==null?void 0:oe.value}),{value:(G=O.current[n])==null?void 0:G.value,type:p}))},[c,F,O]),K=e.useCallback(n=>{var p,I;if((p=Q.current)==null||p.focus({preventScroll:!0}),!((I=O.current[n])!=null&&I.disabled))if(c){let g=ee(n)?"removed":"added",B=Me(n,g);if(B==null)return;h(B),ye(n,g,B),De(B.map(G=>{var H;return(H=O.current[G])==null?void 0:H.label}).filter(Boolean).join(", ")),k&&(v(""),ge(!1))}else h(n),N(),ye(n)},[O,c,ee,Me,h,ye,k,N]),Ee=e.useCallback((n,p)=>{let I=Se(n,C),{__originalIndex:g}=q[I],{icon:B,startIcon:G,label:H,...Ce}=n,oe=G??B,ue=y?y(n,{isFocused:$===g,isSelected:ee(g),index:g,id:I}):null;return ue?e.cloneElement(ue,{onClick:te=>{var ze,$e;K(g),($e=(ze=ue.props).onClick)==null||$e.call(ze,te)},focused:$===g,"data-iui-index":g,"data-iui-filtered-index":p,ref:je(ue.props.ref,te=>{!E&&$===g&&(te==null||te.scrollIntoView({block:"nearest"}))})}):e.createElement(dt,{key:I,id:I,startIcon:oe,...Ce,isSelected:ee(g),onClick:()=>{K(g)},index:g,"data-iui-filtered-index":p},H)},[E,$,C,ee,y,K,q]),Ae=e.useMemo(()=>e.createElement(e.Fragment,null,e.isValidElement(b)?b:e.createElement(Ue,null,e.createElement(Xe,{isMuted:!0},b))),[b]),Oe=Ke({visible:z,onVisibleChange:n=>n?T():N(),matchWidth:!0,middleware:{size:{maxHeight:"var(--iui-menu-max-height)"},...x},closeOnOutsideClick:!0,interactions:{click:!1,focus:!0}});return e.createElement(pe.Provider,{value:e.useMemo(()=>({inputRef:Q,menuRef:X,optionsExtraInfo:q}),[q])},e.createElement(J.Provider,{value:e.useMemo(()=>({id:C,isOpen:z,focusedIndex:$,setFocusedIndex:L,onClickHandler:K,enableVirtualization:E,filteredOptions:se,getMenuItem:Ee,multiple:c,popover:Oe,show:T,hide:N}),[E,se,$,Ee,K,N,C,z,c,Oe,T])},e.createElement(st,{ref:o,disabled:t==null?void 0:t.disabled,...Ie},e.createElement(it,{value:S,disabled:t==null?void 0:t.disabled,...t,onChange:Te,"aria-describedby":[c?`${C}-selected-live`:void 0,t==null?void 0:t["aria-describedby"]].filter(Boolean).join(" "),selectTags:D(d,c)?d==null?void 0:d.map(n=>{let p=r[n],I=Se(p,C),{__originalIndex:g}=q[I];return e.createElement(Je,{key:p.label,label:p.label,onRemove:t!=null&&t.disabled?void 0:()=>{K(g),N()}})}).filter(Boolean):void 0}),e.createElement(nt,{...m,disabled:t==null?void 0:t.disabled,isOpen:z}),c?e.createElement(Qe,{text:Ne,id:`${C}-selected-live`}):null),e.createElement(ut,{as:"div",...R},se.length>0&&!E?se.map(Ee):Ae)))}),Vt=e.forwardRef((a,o)=>{let{children:f,className:i,labelPlacement:r,...s}=a,l=ft(f);return e.createElement(ae,{className:le("iui-input-grid",i),"data-iui-label-placement":r,ref:o,...s},l)});let ft=a=>{let{labelId:o,inputId:f,messageId:i}=mt(a);return e.useMemo(()=>e.Children.map(a,r=>e.isValidElement(r)?r.type===Re||r.type==="label"?Y(r,s=>({...s.props,htmlFor:s.props.htmlFor||f,id:s.props.id||o})):r.type===me?Y(r,s=>({...s.props,id:s.props.id||i})):de(r)||r.type===ce||r.type===fe?pt(r,{labelId:o,inputId:f,messageId:i}):r:r),[a,f,o,i])},mt=a=>{let o=Be(),f,i,r,s=!1,l=!1,u=t=>{var m;if(e.isValidElement(t)){if(t.type===we)return((m=t.props.inputProps)==null?void 0:m.id)||`${o}--input`;if(t.type!==ne)return t.props.id||`${o}--input`}};return e.Children.forEach(a,t=>{e.isValidElement(t)&&((t.type===Re||t.type==="label")&&(s=!0,f||(f=t.props.id||`${o}--label`)),t.type===me&&(r||(r=t.props.id||`${o}--message`)),t.type===ce||t.type===fe?e.Children.forEach(t.props.children,m=>{de(m)&&(i||(i=u(m)))}):de(t)&&(i||(i=u(t))),t.type===ne&&(l=!0))}),{labelId:l?f:void 0,inputId:s&&!l?i:void 0,messageId:r}},pt=(a,{labelId:o,inputId:f,messageId:i})=>{let r=(l={})=>{let u=[l["aria-describedby"],i].filter(Boolean).join(" ");return{...l,...a.type!==ne&&{id:l.id||f},"aria-describedby":(u==null?void 0:u.trim())||void 0}},s=l=>l.type===we?Y(l,u=>({inputProps:r(u.props.inputProps)})):l.type===ne?Y(l,u=>({triggerProps:{"aria-labelledby":o,...r(u.props.triggerProps)}})):Y(l,u=>r(u.props));return a.type===ce||a.type===fe?Y(a,l=>({children:e.Children.map(l.props.children,u=>e.isValidElement(u)&&de(u)?s(u):u)})):s(a)},de=a=>e.isValidElement(a)&&(a.type==="input"||a.type==="textarea"||a.type==="select"||a.type===Fe||a.type===Ge||a.type===ce.Input||a.type===ne||a.type===we);export{we as C,Vt as I,me as S};
